# This file contains the model used to test a range of
# basic constraints.

##
# WARNING: When adding tests for new constraints, we now
# want to create separate models, as in the example of
# `model_demand_share.yaml`, which can double as minimal
# working examples of the given functionality.
##

import:
  - scenarios.yaml

config:
  init:
    name: Test model
    timeseries_data_path: "timeseries_data"
  build:
    mode: plan
  solve:
    solver: cbc

techs:
  test_supply_gas:
    essentials:
      name: Supply tech
      carrier: gas
      parent: supply
    constraints:
      flow_cap_max: 15
      source_max: .inf
      flow_eff: 0.9

  test_supply_elec:
    essentials:
      name: Supply tech
      carrier: electricity
      parent: supply
    constraints:
      flow_cap_max: 10
      source_max: .inf
      flow_eff: 0.9

  test_supply_coal:
    essentials:
      name: Supply tech
      carrier: coal
      parent: supply
    constraints:
      flow_cap_max: 10
      source_max: .inf
      flow_eff: 0.9

  test_supply_plus:
    essentials:
      name: Supply plus tech
      carrier: electricity
      parent: supply_plus
    constraints:
      flow_cap_max: 15
      source_max: file=supply_plus_resource.csv
      source_eff: 0.9
      flow_eff: 0.9
      storage_cap_max: 35
      flow_cap_per_storage_cap_max: 0.5
      storage_loss: 0.01
    switches:
      include_storage: true

  test_storage:
    essentials:
      name: Storage tech
      carrier: electricity
      parent: storage
    constraints:
      flow_cap_max: 10
      storage_cap_max: 15
      flow_cap_per_storage_cap_max: 0.5
      flow_eff: 0.9
      storage_loss: 0.01

  test_conversion:
    essentials:
      name: Conversion tech
      carrier_in: gas
      carrier_out: heat
      parent: conversion
    constraints:
      flow_cap_max: 15
      flow_eff: 0.9

  test_conversion_plus:
    essentials:
      name: Conversion plus tech
      primary_carrier_out: electricity
      carrier_in: gas
      carrier_out: electricity
      carrier_out_2: heat
      parent: conversion_plus
    constraints:
      flow_cap_max: 20
      carrier_ratios:
        carrier_out_2: { heat: 0.8 }

  test_chp:
    essentials:
      name: Conversion plus tech
      primary_carrier_out: electricity
      carrier_in: gas
      carrier_out: [electricity, heat]
      parent: conversion_plus
    constraints:
      flow_cap_max: 20

  test_demand_elec:
    essentials:
      name: Demand elec tech
      carrier: electricity
      parent: demand
    constraints:
      sink_equals: file=demand_elec.csv

  test_demand_heat:
    essentials:
      name: Demand heat tech
      carrier: heat
      parent: demand
    constraints:
      sink_equals: file=demand_heat.csv

  test_demand_coal:
    essentials:
      name: Demand coal tech
      carrier: coal
      parent: demand
    constraints:
      sink_max: 10

  test_transmission_elec:
    essentials:
      name: Transmission elec tech
      carrier: electricity
      parent: transmission
    constraints:
      flow_cap_max: 10

  test_transmission_heat:
    essentials:
      name: Transmission heat tech
      carrier: heat
      parent: transmission
    constraints:
      flow_cap_max: 5

links:
  a,b:
    techs:
      test_transmission_elec:
        distance: 1
      test_transmission_heat:
        distance: 2
